---
tags:
  - TypeScript
---

```typescript
// 泛型基础语法
function identity<T>(arg: T): T {
    return arg;
}

// 使用泛型
let result1 = identity<string>("hello");    // 显式指定类型
let result2 = identity(42);                 // 类型推断为 number

// 泛型约束（extends关键字）
interface Lengthwise {
    length: number;
}

function getLength<T extends Lengthwise>(arg: T): number {
    return arg.length;  // 现在可以安全访问 length 属性
}

getLength("hello");        // ✅ 字符串有 length 属性
getLength([1, 2, 3]);      // ✅ 数组有 length 属性
// getLength(123);         // ❌ 数字没有 length 属性
```
感觉和`C#`差不多，把`where`关键字换成`extends`

```typescript
// 联合 keyof 获取对象键的约束
function getProperty<T, K extends keyof T>(obj: T, key: K): T[K] {
    return obj[key];
}

interface Person {
    name: string;
    age: number;
    email: string;
}

const person: Person = {
    name: "张三",
    age: 30,
    email: "zhang@example.com"
};

// K 被约束为 Person 的键：'name' | 'age' | 'email'
const name = getProperty(person, "name");     // 类型为 string
const age = getProperty(person, "age");       // 类型为 number
// const invalid = getProperty(person, "invalid"); // ❌ 错误
```

联合`keyof`获取字典键约束

#### 泛型接口与泛型类

```typescript
// 泛型接口
interface GenericRepository<T> {
    getById(id: number): T | undefined;
    save(entity: T): void;
    delete(id: number): void;
    findAll(): T[];
}

// 泛型类
class DataRepository<T extends { id: number }> implements GenericRepository<T> {
    private data: T[] = [];
    
    getById(id: number): T | undefined {
        return this.data.find(item => item.id === id);
    }
    
    save(entity: T): void {
        const existingIndex = this.data.findIndex(item => item.id === entity.id);
        if (existingIndex >= 0) {
            this.data[existingIndex] = entity;
        } else {
            this.data.push(entity);
        }
    }
    
    delete(id: number): void {
        this.data = this.data.filter(item => item.id !== id);
    }
    
    findAll(): T[] {
        return [...this.data];
    }
}

// 使用泛型类
interface User {
    id: number;
    name: string;
    email: string;
}

const userRepo = new DataRepository<User>();
userRepo.save({ id: 1, name: "张三", email: "zhang@example.com" });
const user = userRepo.getById(1);
```