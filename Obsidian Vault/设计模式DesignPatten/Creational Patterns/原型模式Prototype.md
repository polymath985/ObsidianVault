---
tags:
  - 设计模式
  - CSharp
---
# 定义

原型模式是用原型实例指定创建对象的种类，并通过拷贝这些原型创建新的对象。简单来说，首先创建一个实例，然后通过这个实例去拷贝（克隆）创建新的实例。

# 基本实现

只需要在建造者模式的基础上，在被构建的产品中写入`Clone`方法

![[Pasted image 20250527110819.png]]

![[Pasted image 20250527111129.png]]
# 使用场景

- 需要创建一个包含大量公共属性，而只需要修改少量属性的对象时
- 当需要重复创建一个初始化需要消耗大量资源的对象时

# 基本实现的缺点

- 仍然通过直接`new`来生成新对象，性能开销极大
- `clone`方法违背开闭原则

# 解决方案

## MemberwiseClone方法

调用`object`父类之中`MemberWiseClone`方法，产生一个浅拷贝结果

![[Pasted image 20250531105602.png]]![[Pasted image 20250531105914.png]]
对字符串来说，每次修改会创建新的位置，改变地址，所以不会影响原型，但对其他引用类型就不行了

可是，这样是浅拷贝，外界更改可能会影响数据错乱

## 序列化方法

使用时需要给类及其成员打上`[Serializable]`

这样的话，一般将该类打上`sealed`防止被子类继承

![[Pasted image 20250531111256.png]]*图：序列化克隆(方法似乎已过期？)*

